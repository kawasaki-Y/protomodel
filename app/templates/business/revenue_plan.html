{% extends "base.html" %}

{% block title %}収益計画 | 経営管理システム{% endblock %}

{% block styles %}
{{ super() }}
<style>
.revenue-table th, .revenue-table td {
    min-width: 120px;
}
.revenue-table input {
    width: 100%;
    padding: 0.25rem;
}
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="mb-8">
        <h1 class="text-2xl font-bold mb-4">収益計画</h1>
        <p class="text-gray-600">事業ごとの収益計画を作成・管理します。</p>
    </div>

    <!-- 事業選択タブ -->
    <div class="mb-6">
        <div class="border-b border-gray-200">
            <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                {% for business in businesses %}
                <button class="business-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"
                        data-business-id="{{ business.id }}"
                        onclick="switchBusiness({{ business.id }})">
                    {{ business.name }}
                </button>
                {% endfor %}
            </nav>
        </div>
    </div>

    <!-- 収益計画テーブル -->
    <div class="bg-white rounded-lg shadow overflow-x-auto">
        <table id="revenue-table" class="min-w-full divide-y divide-gray-200 revenue-table">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">顧客</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">単価</th>
                    {% for month in range(1, 13) %}
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        {{ month }}月
                    </th>
                    {% endfor %}
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">合計</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                <!-- JavaScriptで動的に生成 -->
            </tbody>
            <tfoot class="bg-gray-50">
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap font-bold">合計</td>
                    <td></td>
                    {% for month in range(1, 13) %}
                    <td class="px-6 py-4 whitespace-nowrap font-bold month-total" data-month="{{ month }}">0</td>
                    {% endfor %}
                    <td class="px-6 py-4 whitespace-nowrap font-bold grand-total">0</td>
                </tr>
            </tfoot>
        </table>
    </div>

    <!-- 保存ボタン -->
    <div class="mt-8 flex justify-end">
        <button onclick="saveRevenuePlan()" 
                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
            <i class="fas fa-save mr-2"></i>保存
        </button>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='js/revenue_plan.js') }}"></script>
{% endblock %} 